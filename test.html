<script src="https://cdn.jsdelivr.net/npm/dayjs@1/dayjs.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/dayjs@1/plugin/duration.js"></script>
<script>
dayjs.extend(dayjs_plugin_duration);

// áƒ¤áƒ£áƒœáƒ¥áƒªáƒ˜áƒ SMS áƒ¡áƒ¢áƒ áƒ˜áƒ¥áƒáƒœáƒ˜áƒ“áƒáƒœ áƒ—áƒáƒ áƒ˜áƒ¦áƒ˜áƒ¡ áƒ’áƒáƒ“áƒáƒ¥áƒªáƒ”áƒ•áƒ˜áƒ¡áƒ—áƒ•áƒ˜áƒ¡
function parseSmsDate(smsDate) {
  // áƒ¤áƒáƒ áƒ›áƒáƒ¢áƒ˜: "dd-mm-yyyy:HH:MM:SS"
  const parts = smsDate.split(/[-:]/); // [dd, mm, yyyy, HH, MM, SS]
  return dayjs(`${parts[2]}-${parts[1]}-${parts[0]}T${parts[3]}:${parts[4]}:${parts[5]}`);
}

// áƒ«áƒ˜áƒ áƒ˜áƒ—áƒáƒ“áƒ˜ áƒ¡áƒ®áƒ•áƒáƒáƒ‘áƒ˜áƒ¡ áƒ¤áƒ£áƒœáƒ¥áƒªáƒ˜áƒ
function computeDiffObject(fromSms, toSms) {
  const start = parseSmsDate(fromSms);
  const end = parseSmsDate(toSms);

  const years = end.diff(start, 'year');
  const afterYears = start.add(years, 'year');
  const months = end.diff(afterYears, 'month');
  const afterMonths = afterYears.add(months, 'month');
  const days = end.diff(afterMonths, 'day');
  const afterDays = afterMonths.add(days, 'day');
  const hours = end.diff(afterDays, 'hour');
  const afterHours = afterDays.add(hours, 'hour');
  const minutes = end.diff(afterHours, 'minute');
  const afterMinutes = afterHours.add(minutes, 'minute');
  const seconds = end.diff(afterMinutes, 'second');

  return {
    years: years,
    months: months,
    days: days,
    hours: hours,
    minutes: minutes,
    seconds: seconds
  };
}

// WebView áƒáƒœ Console áƒ’áƒáƒ›áƒáƒ¡áƒáƒ§áƒ”áƒœáƒ”áƒ‘áƒšáƒáƒ“
function computeDiffAndSend(fromSms, toSms) {
  const res = computeDiffObject(fromSms, toSms);
  const payload = JSON.stringify(res);

  if (window.ReactNativeWebView && typeof window.ReactNativeWebView.postMessage === 'function') {
    window.ReactNativeWebView.postMessage(payload);
  } else if (window.parent && typeof window.parent.postMessage === 'function') {
    window.parent.postMessage(payload, '*');
  } else {
    console.log(payload); // áƒ‘áƒ áƒáƒ£áƒ–áƒ”áƒ áƒ˜áƒ¡ áƒ¢áƒ”áƒ¡áƒ¢áƒ˜áƒ¡áƒ—áƒ•áƒ˜áƒ¡
  }

  return payload;
}

// áƒ’áƒáƒ¡áƒáƒ¢áƒ”áƒ¡áƒ¢áƒáƒ“
console.log(computeDiffAndSend("5-10-2025:12:54:28", "29-10-2025:11:30:0"));
</script>
ğŸ”¹ áƒ áƒáƒ¡ áƒáƒ™áƒ”áƒ—áƒ”áƒ‘áƒ¡ áƒ™áƒáƒ“áƒ˜
parseSmsDate() â€“ áƒ’áƒáƒ áƒ“áƒáƒ¥áƒ›áƒœáƒ˜áƒ¡ áƒ¡áƒ›áƒ¡ áƒ¡áƒ¢áƒ áƒ˜áƒ¥áƒáƒœáƒ¡ Day.js áƒáƒ‘áƒ˜áƒ”áƒ¥áƒ¢áƒáƒ“

computeDiffObject() â€“ áƒ˜áƒ—áƒ•áƒšáƒ˜áƒ¡ áƒ¡áƒ®áƒ•áƒáƒáƒ‘áƒáƒ¡ year, month, day, hour, minute, second

computeDiffAndSend() â€“ áƒ’áƒáƒ›áƒáƒ’áƒ˜áƒ’áƒ–áƒáƒ•áƒœáƒ˜áƒ¡ JSON áƒ¨áƒ”áƒ“áƒ”áƒ’áƒ¡ WebView-áƒ¨áƒ˜ áƒáƒœ Console-áƒ¨áƒ˜

ğŸ”¹ áƒ¢áƒ”áƒ¡áƒ¢áƒ˜áƒ¡ áƒ¨áƒ”áƒ“áƒ”áƒ’áƒ˜ áƒáƒ› áƒ›áƒáƒœáƒáƒªáƒ”áƒ›áƒ”áƒ‘áƒ˜áƒ—:
json
áƒ™áƒáƒ“áƒ˜áƒ¡ áƒ™áƒáƒáƒ˜áƒ áƒ”áƒ‘áƒ
{
  "years": 0,
  "months": 0,
  "days": 23,
  "hours": 22,
  "minutes": 35,
  "seconds": 32
}

